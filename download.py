import requests
import zipfile
from pathlib import Path


def download_file_from_nishika(download_url: str, dirpath: Path, unzip: bool = True) -> None:
    """
    指定したURLからファイルをダウンロードし、指定したディレクトリに保存します。

    Args:
        download_url (str): ダウンロードするファイルのURL (データタブにある `COPY URL`)
        dirpath (Path): ファイルを保存するディレクトリのパス
        unzip (bool): ダウンロードしたファイルがZIP形式の場合に解凍するかどうかを指定。デフォルトはTrue

    Returns:
        None
    """

    # ファイルのダウンロードと保存
    response = requests.get(download_url)
    filename = download_url.split("?")[-2].split("/")[-1]
    filepath = dirpath / filename
    # print(filename)

    if not filepath.is_file():
        with open(filepath, "wb") as f:
            f.write(response.content)

        if unzip and filename.endswith(".zip"):
            # ! unzip -d $dirpath $filepath
            with zipfile.ZipFile(filepath, 'r') as zip_ref:
                zip_ref.extractall(dirpath)


# 要変更
download_urls = [
    # train.csv
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/train.csv?response-content-disposition=attachment%3B%20filename%3Dtrain.csv&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=Lr9B%2Bc5vEdMRWGGnwoS7%2BdmG1D0%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
    # test.csv
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/test.csv?response-content-disposition=attachment%3B%20filename%3Dtest.csv&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=5Nlu0r1J7Nsd6vWAhlgLsuDoi%2FE%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
    # sample_submission.csv
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/sample_submission.csv?response-content-disposition=attachment%3B%20filename%3Dsample_submission.csv&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=4JNycCnWS%2F%2FYUuThj3cr6XmFtAM%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
    # query_images.zip
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/query_images.zip?response-content-disposition=attachment%3B%20filename%3Dquery_images.zip&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=EPqche9wVwohwIveQPekc7xFMSw%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
    # data_explanation.xlsx
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/data_explanation.xlsx?response-content-disposition=attachment%3B%20filename%3Ddata_explanation.xlsx&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=OtyKyRnfGSqIHO%2FCIZvcO1eORK8%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
    # cite.csv
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/cite.csv?response-content-disposition=attachment%3B%20filename%3Dcite.csv&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=SKFSihnYsDoh%2FRjKKQRBEWQqqrY%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
    # cite_images.zip
    "https://s3.ap-northeast-1.amazonaws.com/nishika.assets.private/competitions/48/data/cite_images.zip?response-content-disposition=attachment%3B%20filename%3Dcite_images.zip&AWSAccessKeyId=ASIA3NMWWMCV7EXIUZVZ&Signature=rrrUf59Zc8gtb3oUtAQmS%2FJ6JaA%3D&x-amz-security-token=IQoJb3JpZ2luX2VjEAQaDmFwLW5vcnRoZWFzdC0xIkYwRAIgc6NkH2gjSULrhAcq997B4isOlD4zBEL%2F5c0akOQW7KICIDoiH9KcMrxvGSsi0x9aBs%2F6GAiiHJA7OF%2FKhT%2BCJqrwKoIECG0QBBoMNzg0Njg0NDQxNzcxIgyaFzgXY68ZLzMJ%2Fqoq3wNhRszqdZ%2FUDUroVU76IGqM45%2BOWgJ8f%2B63HX6XPVG7AaZevRIgwpfLBfXIvbdZp25ZYcz%2Bi4%2F93VBChXev5qdxZokviWeHrAc9XM4%2FPEbeYsqFatSVNSrXPHpWDc89hIX7zbJPU3UMEODz5HYtGqXPjcZQKbath7zX0XwJc8hI4rd0UwD3QsjDhBhWwJhcdCo%2F6cFgzYgB6AmJwHprpFKgTglEFvi3nDZ3ewEw4TezyuFQaLIdItw5y21XwaMJSpwhwVj68Sd3caWRcR8mTaguZI%2Fw3w1VsbvtJ9kEqvxS0%2BRHTj31euN2c4TxUxq0YgW0KhsGbwxuQen8LpR5NJe9hMBESBSIc5J5ZIeKVVw34g%2FtERhBJXrJjsa%2F1Kf1Xt9TbfzvrVGHjOiU%2BATPxenJoMSbdhTKnVJopIq0f1GzR8pFTZPMKRhBsgDzcRHI65JLIAgawLtKZIIt%2B0QhmcKr3aeyFO246s8N%2Fbf%2BFPnOBv2vL2I8HN8zfsftpXo3SxeXKiGWff%2BUPv4MR1%2F4R%2BUEMZ%2Fyyz7nnRfPxwuwgZDh2Ssqah80OQSvhOjhcYpRsHpUBmJzgU1FsMtSPYVC6JfB%2B3LNB7na691ipxAcx2ErAHt8Akgjfe06T%2F%2BKx8aeYjDG2%2B6kBjqmAWgV0WPFpBLKOc5Lgb2wxMXVYkOC1DIxlGjKSScOgIgnm1hXFXJGcPnp5gnIEsubPzsweGYfxq0YgZIXEGnFugbf%2Fu02avnGYnCodFxtbWpyEyfeu%2BmDft4i1%2Fj3L9dwBVdmbNcjY6bh%2FbYtzz0DIfl7nGf95zf9ruTz4yodsMfQIWCqI3DP6el3DXyWMJ5gwvQoSBzrHmwyFUQjD46Pk2lmO5AkjiM%3D&Expires=1687933347",
]

for download_url in download_urls:
    download_file_from_nishika(download_url, dirpath=INPUTS)
